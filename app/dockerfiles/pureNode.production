FROM node:18

# Update our image
RUN apt-get -y update && \
    apt-get -y upgrade && \
    apt-get clean

# Set our working directory
WORKDIR /srv

# Copy in our package.json and other root files
COPY Entrypoint.sh package.json postcss.config.js ./

# Annoyed this has to be its own layer, fix it if you know how
COPY src /srv/src

# Then install any dependencies, this will help with caching
RUN npm install --omit=dev

# Run our app
ENTRYPOINT [ "/srv/Entrypoint.sh" ]
CMD ["npm", "start"]
